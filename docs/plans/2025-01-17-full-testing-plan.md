# AutoGeo å…¨æµç¨‹æµ‹è¯•æ–¹æ¡ˆ

> è®¾è®¡æ—¥æœŸ: 2025-01-17
> è®¾è®¡è€…: å¼€å‘è€…
> ç›®æ ‡: å¼€å‘é˜¶æ®µéªŒè¯ - ç¡®ä¿ç¨‹åºè¿è¡Œæ— é”™è¯¯ã€å‰åç«¯äº¤äº’æ­£ç¡®ã€åŠŸèƒ½å®ç°å®Œæ•´

## ä¸€ã€æµ‹è¯•æ¶æ„è®¾è®¡

### 1.1 ç›®å½•ç»“æ„

```
tests/
â”œâ”€â”€ conftest.py                  # Pytesté…ç½®å’ŒFixtures
â”œâ”€â”€ run_tests.py                 # ä¸€é”®è¿è¡Œè„šæœ¬
â”œâ”€â”€ helpers/                     # æµ‹è¯•è¾…åŠ©å·¥å…·
â”‚   â”œâ”€â”€ app_launcher.py          # è‡ªåŠ¨å¯åŠ¨å‰åç«¯
â”‚   â”œâ”€â”€ browser_helper.py        # Playwright MCPå°è£…
â”‚   â”œâ”€â”€ mock_data.py             # Mockæ•°æ®ç”Ÿæˆå™¨
â”‚   â””â”€â”€ error_collector.py       # é”™è¯¯æ”¶é›†å™¨
â”œâ”€â”€ test_geo/                    # GEOå…³é”®è¯æ¨¡å—æµ‹è¯•
â”‚   â”œâ”€â”€ test_projects.py         # é¡¹ç›®ç®¡ç†æµ‹è¯•
â”‚   â”œâ”€â”€ test_keywords.py         # å…³é”®è¯ç®¡ç†æµ‹è¯•
â”‚   â””â”€â”€ test_distill.py          # å…³é”®è¯è’¸é¦æµ‹è¯•
â”œâ”€â”€ test_monitor/                # AIæ£€æµ‹ç›‘æ§æ¨¡å—æµ‹è¯•
â”‚   â”œâ”€â”€ test_index_check.py      # æ”¶å½•æ£€æµ‹æµ‹è¯•
â”‚   â”œâ”€â”€ test_reports.py          # æ•°æ®æŠ¥è¡¨æµ‹è¯•
â”‚   â”œâ”€â”€ test_notifications.py    # é¢„è­¦é€šçŸ¥æµ‹è¯•
â”‚   â””â”€â”€ test_scheduler.py        # å®šæ—¶ä»»åŠ¡æµ‹è¯•
â”œâ”€â”€ test_publish/                # æ–‡ç« å‘å¸ƒæ¨¡å—æµ‹è¯•
â”‚   â”œâ”€â”€ test_account.py          # è´¦å·ç®¡ç†æµ‹è¯•
â”‚   â”œâ”€â”€ test_article_editor.py   # æ–‡ç« ç¼–è¾‘æµ‹è¯•
â”‚   â””â”€â”€ test_publish_flow.py     # å‘å¸ƒæµç¨‹æµ‹è¯•
â””â”€â”€ reports/                     # æµ‹è¯•æŠ¥å‘Š
    â”œâ”€â”€ .gitkeep
    â””â”€â”€ [timestamp]/             # æ—¶é—´æˆ³ç›®å½•
        â”œâ”€â”€ screenshot_*.png
        â”œâ”€â”€ page_source.html
        â”œâ”€â”€ console_errors.log
        â””â”€â”€ error_summary.txt
```

### 1.2 æŠ€æœ¯æ–¹æ¡ˆ

| ç»„ä»¶ | æŠ€æœ¯é€‰å‹ | è¯´æ˜ |
|------|----------|------|
| æµ‹è¯•æ¡†æ¶ | pytest + pytest-html | Pythonæµ‹è¯•æ¡†æ¶ |
| æµè§ˆå™¨è‡ªåŠ¨åŒ– | Playwright MCP | å…ƒç´ å®šä½ã€äº¤äº’æ“ä½œ |
| æœåŠ¡å¯åŠ¨ | subprocess | è‡ªåŠ¨å¯åŠ¨å‰åç«¯ |
| æ•°æ®æ¨¡å¼ | Mock + çœŸå® | ç¯å¢ƒå˜é‡æ§åˆ¶åˆ‡æ¢ |

### 1.3 ç¯å¢ƒå˜é‡æ§åˆ¶

```bash
# Mockæ¨¡å¼ï¼ˆé»˜è®¤ï¼‰- ä¸è°ƒç”¨çœŸå®AIæœåŠ¡
REAL_AI=false

# çœŸå®æ¨¡å¼ - éœ€è¦é…ç½®AI APIå¯†é’¥
REAL_AI=true
```

---

## äºŒã€GEOå…³é”®è¯æ¨¡å—æµ‹è¯•

### 2.1 é¡¹ç›®ç®¡ç†æµ‹è¯• (test_projects.py)

| ç”¨ä¾‹åç§° | æµ‹è¯•æ­¥éª¤ | éªŒè¯ç‚¹ |
|----------|----------|--------|
| test_create_project | 1. å¯¼èˆªåˆ°å…³é”®è¯é¡µé¢<br>2. ç‚¹å‡»æ–°å»ºé¡¹ç›®<br>3. å¡«å†™åç§°/æè¿°<br>4. æäº¤ | â€¢ é¡¹ç›®å‡ºç°åœ¨åˆ—è¡¨ä¸­<br>â€¢ æ— JSæŠ¥é”™<br>â€¢ æ•°æ®åº“è®°å½•å­˜åœ¨ |
| test_list_projects | 1. å¯¼èˆªåˆ°å…³é”®è¯é¡µé¢ | â€¢ é¡¹ç›®åˆ—è¡¨æ­£ç¡®æ˜¾ç¤º<br>â€¢ åˆ†é¡µåŠŸèƒ½æ­£å¸¸ |
| test_delete_project | 1. é€‰æ‹©é¡¹ç›®<br>2. ç‚¹å‡»åˆ é™¤<br>3. ç¡®è®¤ | â€¢ é¡¹ç›®ä»åˆ—è¡¨æ¶ˆå¤±<br>â€¢ æ•°æ®åº“è®°å½•åˆ é™¤ |
| test_edit_project | 1. é€‰æ‹©é¡¹ç›®<br>2. ç¼–è¾‘ä¿¡æ¯<br>3. ä¿å­˜ | â€¢ ä¿¡æ¯æ›´æ–°æˆåŠŸ<br>â€¢ åˆ—è¡¨æ˜¾ç¤ºæœ€æ–°æ•°æ® |

### 2.2 å…³é”®è¯ç®¡ç†æµ‹è¯• (test_keywords.py)

| ç”¨ä¾‹åç§° | æµ‹è¯•æ­¥éª¤ | éªŒè¯ç‚¹ |
|----------|----------|--------|
| test_add_keywords | 1. é€‰æ‹©é¡¹ç›®<br>2. æ‰¹é‡æ·»åŠ å…³é”®è¯<br>3. ä¿å­˜ | â€¢ å…³é”®è¯æ·»åŠ æˆåŠŸ<br>â€¢ è¡¨æ ¼æ˜¾ç¤ºæ–°æ•°æ® |
| test_keyword_list_pagination | 1. æ·»åŠ å¤§é‡å…³é”®è¯<br>2. ç¿»é¡µæ“ä½œ | â€¢ åˆ†é¡µå™¨æ­£ç¡®æ˜¾ç¤º<br>â€¢ æ¯é¡µæ•°æ®é‡æ­£ç¡® |
| test_keyword_search | 1. è¾“å…¥æœç´¢è¯<br>2. è§¦å‘æœç´¢ | â€¢ è¿‡æ»¤ç»“æœæ­£ç¡®<br>â€¢ é«˜äº®æ˜¾ç¤ºåŒ¹é… |
| test_delete_keyword | 1. é€‰æ‹©å…³é”®è¯<br>2. ç‚¹å‡»åˆ é™¤ | â€¢ å…³é”®è¯ä»åˆ—è¡¨æ¶ˆå¤± |
| test_keyword_stats | 1. æŸ¥çœ‹å…³é”®è¯ç»Ÿè®¡ | â€¢ ç»Ÿè®¡æ•°æ®æ­£ç¡®æ˜¾ç¤º |

### 2.3 å…³é”®è¯è’¸é¦æµ‹è¯• (test_distill.py)

| ç”¨ä¾‹åç§° | æµ‹è¯•æ­¥éª¤ | éªŒè¯ç‚¹ |
|----------|----------|--------|
| test_distill_ui | 1. å¯¼èˆªåˆ°è’¸é¦é¡µé¢ | â€¢ UIå…ƒç´ å®Œæ•´åŠ è½½<br>â€¢ æ— æ§åˆ¶å°é”™è¯¯ |
| test_distill_submit | 1. è¾“å…¥å…³é”®è¯<br>2. æäº¤è’¸é¦è¯·æ±‚ | â€¢ LoadingçŠ¶æ€æ˜¾ç¤º<br>â€¢ è¯·æ±‚æ­£ç¡®å‘é€ |
| test_distill_result | 1. ç­‰å¾…è’¸é¦å®Œæˆ<br>2. æŸ¥çœ‹ç»“æœ | â€¢ ç»“æœæ­£ç¡®æ˜¾ç¤º<br>â€¢ Mockæ•°æ®è¿”å›æ­£ç¡® |
| test_generate_questions | 1. é€‰æ‹©å…³é”®è¯<br>2. ç”Ÿæˆé—®é¢˜å˜ä½“ | â€¢ é—®é¢˜åˆ—è¡¨ç”Ÿæˆ<br>â€¢ å˜ä½“æ•°é‡æ­£ç¡® |
| test_export_keywords | 1. é€‰æ‹©å…³é”®è¯<br>2. ç‚¹å‡»å¯¼å‡º | â€¢ æ–‡ä»¶æ­£ç¡®ä¸‹è½½ |

---

## ä¸‰ã€AIæ£€æµ‹ç›‘æ§æ¨¡å—æµ‹è¯•

### 3.1 æ”¶å½•æ£€æµ‹æµ‹è¯• (test_index_check.py)

| ç”¨ä¾‹åç§° | æµ‹è¯•æ­¥éª¤ | éªŒè¯ç‚¹ |
|----------|----------|--------|
| test_check_ui_loaded | 1. å¯¼èˆªåˆ°æ£€æµ‹é¡µé¢ | â€¢ UIå…ƒç´ å®Œæ•´åŠ è½½<br>â€¢ å¹³å°é€‰æ‹©å™¨å¯ç”¨ |
| test_single_check | 1. é€‰æ‹©å•ä¸ªå…³é”®è¯<br>2. æ‰‹åŠ¨è§¦å‘æ£€æµ‹ | â€¢ æ£€æµ‹çŠ¶æ€æ›´æ–°<br>â€¢ Mockè¿”å›æ­£ç¡® |
| test_batch_check | 1. é€‰æ‹©å¤šä¸ªå…³é”®è¯<br>2. æ‰¹é‡æ£€æµ‹ | â€¢ æ‰¹é‡å¤„ç†æ­£å¸¸<br>â€¢ è¿›åº¦æ¡æ›´æ–° |
| test_platform_toggle | 1. åˆ‡æ¢AIå¹³å°<br>2. é‡æ–°æ£€æµ‹ | â€¢ å¹³å°åˆ‡æ¢ç”Ÿæ•ˆ |
| test_check_records | 1. æŸ¥çœ‹æ£€æµ‹å†å² | â€¢ å†å²è®°å½•æ­£ç¡®æ˜¾ç¤º |
| test_trend_chart | 1. é€‰æ‹©å…³é”®è¯<br>2. æŸ¥çœ‹è¶‹åŠ¿å›¾ | â€¢ å›¾è¡¨æ­£ç¡®æ¸²æŸ“ |

### 3.2 æ•°æ®æŠ¥è¡¨æµ‹è¯• (test_reports.py)

| ç”¨ä¾‹åç§° | æµ‹è¯•æ­¥éª¤ | éªŒè¯ç‚¹ |
|----------|----------|--------|
| test_overview_dashboard | 1. å¯¼èˆªåˆ°æŠ¥è¡¨é¡µé¢ | â€¢ æ•°æ®å¡ç‰‡æ­£ç¡®æ˜¾ç¤º |
| test_trend_chart_render | 1. æŸ¥çœ‹æ”¶å½•è¶‹åŠ¿å›¾ | â€¢ EChartså›¾è¡¨æ¸²æŸ“<br>â€¢ æ•°æ®ç‚¹æ­£ç¡® |
| test_ranking_table | 1. æŸ¥çœ‹æ’åè¡¨æ ¼ | â€¢ æ’åºåŠŸèƒ½æ­£å¸¸<br>â€¢ æ•°æ®å‡†ç¡® |
| test_platform_distribution | 1. æŸ¥çœ‹å¹³å°åˆ†å¸ƒé¥¼å›¾ | â€¢ é¥¼å›¾æ­£ç¡®æ˜¾ç¤º |
| test_date_range_filter | 1. é€‰æ‹©æ—¥æœŸèŒƒå›´<br>2. åº”ç”¨ç­›é€‰ | â€¢ ç­›é€‰ç»“æœæ­£ç¡® |

### 3.3 é¢„è­¦é€šçŸ¥æµ‹è¯• (test_notifications.py)

| ç”¨ä¾‹åç§° | æµ‹è¯•æ­¥éª¤ | éªŒè¯ç‚¹ |
|----------|----------|--------|
| test_notification_list | 1. å¯¼èˆªåˆ°é¢„è­¦é¡µé¢ | â€¢ é¢„è­¦åˆ—è¡¨åŠ è½½<br>â€¢ æœªè¯»æ ‡è®°æ­£ç¡® |
| test_rules_display | 1. æŸ¥çœ‹é¢„è­¦è§„åˆ™ | â€¢ è§„åˆ™é…ç½®æ­£ç¡®æ˜¾ç¤º |
| test_warning_trigger | 1. æ¨¡æ‹Ÿä½å‘½ä¸­ç‡<br>2. è§¦å‘æ£€æµ‹ | â€¢ é¢„è­¦æ­£ç¡®ç”Ÿæˆ |
| test_warning_dismiss | 1. é€‰æ‹©é¢„è­¦<br>2. æ ‡è®°å·²è¯» | â€¢ çŠ¶æ€æ›´æ–°æˆåŠŸ |

### 3.4 å®šæ—¶ä»»åŠ¡æµ‹è¯• (test_scheduler.py)

| ç”¨ä¾‹åç§° | æµ‹è¯•æ­¥éª¤ | éªŒè¯ç‚¹ |
|----------|----------|--------|
| test_scheduler_status | 1. æŸ¥çœ‹ä»»åŠ¡çŠ¶æ€ | â€¢ çŠ¶æ€æ˜¾ç¤ºæ­£ç¡® |
| test_manual_trigger | 1. æ‰‹åŠ¨è§¦å‘æ£€æµ‹ | â€¢ ä»»åŠ¡ç«‹å³æ‰§è¡Œ |
| test_job_list | 1. æŸ¥çœ‹å·²é…ç½®ä»»åŠ¡ | â€¢ ä»»åŠ¡åˆ—è¡¨å®Œæ•´ |

---

## å››ã€æ–‡ç« å‘å¸ƒæ¨¡å—æµ‹è¯•

### 4.1 è´¦å·ç®¡ç†æµ‹è¯• (test_account.py)

| ç”¨ä¾‹åç§° | æµ‹è¯•æ­¥éª¤ | éªŒè¯ç‚¹ |
|----------|----------|--------|
| test_add_account | 1. é€‰æ‹©å¹³å°<br>2. æ·»åŠ è´¦å·ä¿¡æ¯ | â€¢ è´¦å·æ·»åŠ æˆåŠŸ<br>â€¢ CookieåŠ å¯†å­˜å‚¨ |
| test_account_list | 1. æŸ¥çœ‹è´¦å·åˆ—è¡¨ | â€¢ åˆ—è¡¨æ­£ç¡®æ˜¾ç¤º<br>â€¢ çŠ¶æ€å›¾æ ‡æ­£ç¡® |
| test_account_status | 1. æ£€æŸ¥è´¦å·çŠ¶æ€ | â€¢ åœ¨çº¿çŠ¶æ€æ›´æ–° |
| test_delete_account | 1. é€‰æ‹©è´¦å·<br>2. åˆ é™¤ | â€¢ è´¦å·ä»åˆ—è¡¨æ¶ˆå¤± |

### 4.2 æ–‡ç« ç¼–è¾‘æµ‹è¯• (test_article_editor.py)

| ç”¨ä¾‹åç§° | æµ‹è¯•æ­¥éª¤ | éªŒè¯ç‚¹ |
|----------|----------|--------|
| test_editor_ui_loaded | 1. å¯¼èˆªåˆ°ç¼–è¾‘é¡µé¢ | â€¢ å¯Œæ–‡æœ¬ç¼–è¾‘å™¨åŠ è½½ |
| test_title_input | 1. è¾“å…¥æ ‡é¢˜ | â€¢ æ ‡é¢˜æ­£ç¡®ä¿å­˜ |
| test_content_edit | 1. ç¼–è¾‘å†…å®¹<br>2. æ ¼å¼åŒ–æ–‡æœ¬ | â€¢ å¯Œæ–‡æœ¬åŠŸèƒ½æ­£å¸¸ |
| test_image_upload | 1. ä¸Šä¼ æµ‹è¯•å›¾ç‰‡ | â€¢ ä¸Šä¼ æˆåŠŸ<br>â€¢ é¢„è§ˆæ­£ç¡®æ˜¾ç¤º |
| test_save_draft | 1. å¡«å†™å†…å®¹<br>2. ä¿å­˜è‰ç¨¿ | â€¢ è‰ç¨¿ä¿å­˜æˆåŠŸ |
| test_load_draft | 1. é€‰æ‹©è‰ç¨¿<br>2. åŠ è½½ | â€¢ å†…å®¹æ­£ç¡®æ¢å¤ |

### 4.3 å‘å¸ƒæµç¨‹æµ‹è¯• (test_publish_flow.py)

| ç”¨ä¾‹åç§° | æµ‹è¯•æ­¥éª¤ | éªŒè¯ç‚¹ |
|----------|----------|--------|
| test_platform_selection | 1. å‹¾é€‰å‘å¸ƒå¹³å° | â€¢ å¤šé€‰åŠŸèƒ½æ­£å¸¸ |
| test_single_platform_publish | 1. é€‰æ‹©å•å¹³å°<br>2. å¡«å†™æ–‡ç« <br>3. å‘å¸ƒ | â€¢ å‘å¸ƒæµç¨‹å®Œæ•´<br>â€¢ çŠ¶æ€æ›´æ–°æ­£ç¡® |
| test_multi_platform_publish | 1. é€‰æ‹©å¤šå¹³å°<br>2. å¡«å†™æ–‡ç« <br>3. å‘å¸ƒ | â€¢ å¤šå¹³å°å¹¶è¡Œå‘å¸ƒ |
| test_publish_progress | 1. è§¦å‘å‘å¸ƒ<br>2. è§‚å¯Ÿè¿›åº¦ | â€¢ WebSocketæ¨é€æ­£å¸¸<br>â€¢ è¿›åº¦æ¡æ›´æ–° |
| test_publish_result | 1. æŸ¥çœ‹å‘å¸ƒç»“æœ | â€¢ æˆåŠŸ/å¤±è´¥çŠ¶æ€æ­£ç¡® |
| test_republish | 1. é€‰æ‹©å¤±è´¥æ–‡ç« <br>2. é‡æ–°å‘å¸ƒ | â€¢ é‡è¯•åŠŸèƒ½æ­£å¸¸ |

---

## äº”ã€Playwrightè„šæœ¬è¿è¡ŒéªŒè¯ç‚¹

### 5.1 åŸºç¡€éªŒè¯

| éªŒè¯é¡¹ | è¯´æ˜ |
|--------|------|
| browser_snapshot() | æˆåŠŸè·å–é¡µé¢ç»“æ„ï¼Œå…ƒç´ refå¯å®šä½ |
| å…ƒç´ å®šä½ | elementæè¿°ä¸refæ­£ç¡®åŒ¹é… |
| æ“ä½œæ— è¶…æ—¶ | click/fill/selectæ“ä½œæ— è¶…æ—¶é”™è¯¯ |
| æ§åˆ¶å°æ¸…æ´ | browser_console_messages()æ— errorçº§åˆ« |
| é¡µé¢åŠ è½½ | browser_wait_forçŠ¶æ€æ­£ç¡® |
| WebSocket | å®æ—¶æ¶ˆæ¯æ­£ç¡®æ¥æ”¶ |

### 5.2 äº¤äº’éªŒè¯

| éªŒè¯é¡¹ | è¯´æ˜ |
|--------|------|
| iframeåˆ‡æ¢ | å¯Œæ–‡æœ¬ç¼–è¾‘å™¨iframeæ­£ç¡®åˆ‡æ¢å’Œæ“ä½œ |
| æ–‡ä»¶ä¸Šä¼  | ä¸Šä¼ å¯¹è¯æ¡†æ­£ç¡®è§¦å‘å’Œæäº¤ |
| å¤šé€‰æ“ä½œ | å¹³å°é€‰æ‹©å¤šé€‰æ¡†æ­£ç¡®å‹¾é€‰ |
| loadingçŠ¶æ€ | æŒ‰é’®ç‚¹å‡»åloadingæ­£ç¡®æ˜¾ç¤º |
| åŠ¨æ€æ¸²æŸ“ | è¡¨æ ¼/å›¾è¡¨åŠ¨æ€å†…å®¹åŠ è½½åæ–­è¨€æˆåŠŸ |
| è¿›åº¦æ›´æ–° | è¿›åº¦æ¡/ç™¾åˆ†æ¯”æ­£ç¡®æ›´æ–° |
| ç»“æœå›¾æ ‡ | æˆåŠŸ/å¤±è´¥å›¾æ ‡æ­£ç¡®æ˜¾ç¤º |

---

## å…­ã€é”™è¯¯å¾ªç¯ä¿®å¤æœºåˆ¶

### 6.1 é”™è¯¯å¤„ç†æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¿è¡Œæµ‹è¯•   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    æˆåŠŸ    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ‰€æœ‰é€šè¿‡?  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚   å®Œæˆ!     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ å¤±è´¥
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. æˆªå›¾ä¿å­˜ç°åœº     â”‚
â”‚ 2. æ—¥å¿—è®°å½•é”™è¯¯     â”‚
â”‚ 3. åˆ†æé”™è¯¯ç±»å‹     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é”™è¯¯åˆ†ç±»:                   â”‚
â”‚ â€¢ å‰ç«¯é—®é¢˜ â†’ Vueç»„ä»¶        â”‚
â”‚ â€¢ åç«¯é—®é¢˜ â†’ API/Service    â”‚
â”‚ â€¢ æ•°æ®åº“é—®é¢˜ â†’ Model/Schema â”‚
â”‚ â€¢ å…ƒç´ å®šä½ â†’ Playwrightè„šæœ¬ â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¼€å‘è€…ä¿®å¤ä»£ç     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é‡è·‘ç›¸å…³æµ‹è¯•    â”‚â—€â”€â”€â”€â”€â”€â”€â”
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
        â”‚ å¤±è´¥            â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 é”™è¯¯æ”¶é›†å™¨ (error_collector.py)

```python
class ErrorCollector:
    def save_failure(self, test_name, browser, error):
        """æµ‹è¯•å¤±è´¥æ—¶æ”¶é›†ä¿¡æ¯"""
        self.screenshot(test_name, browser)      # æˆªå›¾
        self.save_page_source(test_name, browser)  # é¡µé¢å¿«ç…§
        self.save_console_logs(test_name, browser) # æ§åˆ¶å°é”™è¯¯
        self.save_network_logs(test_name, browser) # ç½‘ç»œè¯·æ±‚
        self.generate_error_report(test_name, error) # é”™è¯¯æ‘˜è¦
```

### 6.3 æŠ¥å‘Šè¾“å‡º

```
tests/reports/
â”œâ”€â”€ 2025-01-17_143025/
â”‚   â”œâ”€â”€ screenshot_1.png       # å¤±è´¥æˆªå›¾
â”‚   â”œâ”€â”€ page_source.html       # é¡µé¢å¿«ç…§
â”‚   â”œâ”€â”€ console_errors.log     # æ§åˆ¶å°é”™è¯¯
â”‚   â”œâ”€â”€ network_logs.json      # ç½‘ç»œè¯·æ±‚æ—¥å¿—
â”‚   â””â”€â”€ error_summary.txt      # é”™è¯¯æ‘˜è¦
â””â”€â”€ report.html                # Pytest HTMLæŠ¥å‘Š
```

---

## ä¸ƒã€æµ‹è¯•æ‰§è¡Œæµç¨‹

### 7.1 å®Œæ•´æµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    1. å¯åŠ¨é˜¶æ®µ                           â”‚
â”‚  è¿è¡Œ: python tests/run_tests.py                        â”‚
â”‚  â€¢ è‡ªåŠ¨å¯åŠ¨åç«¯æœåŠ¡ (8001ç«¯å£)                          â”‚
â”‚  â€¢ è‡ªåŠ¨å¯åŠ¨å‰ç«¯æœåŠ¡ (5173ç«¯å£)                          â”‚
â”‚  â€¢ å¥åº·æ£€æŸ¥ç¡®ä¿æœåŠ¡å¯ç”¨                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    2. æµ‹è¯•æ‰§è¡Œ                           â”‚
â”‚  â€¢ test_geo/      â†’ GEOå…³é”®è¯æ¨¡å— (9ä¸ªç”¨ä¾‹)             â”‚
â”‚  â€¢ test_monitor/  â†’ AIæ£€æµ‹ç›‘æ§æ¨¡å— (14ä¸ªç”¨ä¾‹)           â”‚
â”‚  â€¢ test_publish/  â†’ æ–‡ç« å‘å¸ƒæ¨¡å— (14ä¸ªç”¨ä¾‹)             â”‚
â”‚  â€¢ å®æ—¶è¾“å‡ºæµ‹è¯•è¿›åº¦                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    3. ç»“æœæ”¶é›†                           â”‚
â”‚  â€¢ æˆåŠŸ: ç»¿è‰²âœ… é€šè¿‡                                     â”‚
â”‚  â€¢ å¤±è´¥: çº¢è‰²âŒ + æˆªå›¾ + æ—¥å¿—                            â”‚
â”‚  â€¢ ç”ŸæˆHTMLæŠ¥å‘Šåˆ° reports/report.html                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    4. é”™è¯¯ä¿®å¤å¾ªç¯                       â”‚
â”‚  â€¢ åˆ†æé”™è¯¯ç±»å‹                                         â”‚
â”‚  â€¢ å¼€å‘è€…ä¿®å¤ä»£ç                                          â”‚
â”‚  â€¢ é‡è·‘ç›¸å…³æµ‹è¯•éªŒè¯                                     â”‚
â”‚  â€¢ å¾ªç¯ç›´åˆ°å…¨éƒ¨é€šè¿‡                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 ä¸€é”®è¿è¡Œè„šæœ¬ (run_tests.py)

```python
import pytest
import subprocess
import sys

def main():
    print("ğŸš€ å¼€å‘è€…å¼€å§‹è·‘æµ‹è¯•äº†...")

    # å¯åŠ¨åº”ç”¨
    # è¿è¡Œpytest
    result = pytest.main([
        "-v", "--tb=short",
        "--html=reports/report.html",
        "--self-contained-html"
    ])

    if result != 0:
        print("\nâŒ ï¼æœ‰æµ‹è¯•å¤±è´¥äº†ï¼Œçœ‹ä¸Šé¢çš„æ—¥å¿—ï¼")
        # æ”¯æŒäº¤äº’å¼é‡è·‘

    return result

if __name__ == "__main__":
    sys.exit(main())
```

---

## å…«ã€éªŒè¯ç‚¹æ±‡æ€»

### 8.1 åŸºç¡€éªŒè¯

| ç±»åˆ« | éªŒè¯é¡¹ |
|------|--------|
| ç¯å¢ƒæ£€æŸ¥ | ç«¯å£8001/5173å¯ç”¨ã€æœåŠ¡æ­£å¸¸å¯åŠ¨ |
| æµè§ˆå™¨ | æ— JSæŠ¥é”™ã€æ— æ§åˆ¶å°error |
| ç½‘ç»œ | APIè¯·æ±‚è¿”å›200ã€WebSocketè¿æ¥æˆåŠŸ |

### 8.2 åŠŸèƒ½éªŒè¯

| æ¨¡å— | æ ¸å¿ƒéªŒè¯ç‚¹ |
|------|------------|
| GEOå…³é”®è¯ | é¡¹ç›®CRUDã€å…³é”®è¯CRUDã€è’¸é¦åŠŸèƒ½ã€å¯¼å‡ºåŠŸèƒ½ |
| AIæ£€æµ‹ç›‘æ§ | æ£€æµ‹åŠŸèƒ½ã€å›¾è¡¨æ¸²æŸ“ã€é¢„è­¦é€šçŸ¥ã€å®šæ—¶ä»»åŠ¡ |
| æ–‡ç« å‘å¸ƒ | è´¦å·ç®¡ç†ã€å¯Œæ–‡æœ¬ç¼–è¾‘ã€å‘å¸ƒæµç¨‹ã€è¿›åº¦è¿½è¸ª |

### 8.3 PlaywrightéªŒè¯

| ç±»åˆ« | éªŒè¯é¡¹ |
|------|--------|
| å…ƒç´ å®šä½ | snapshotè·å–æˆåŠŸã€refå®šä½å‡†ç¡® |
| äº¤äº’æ“ä½œ | click/fill/selectæ— è¶…æ—¶ã€è¾“å…¥æ­£ç¡® |
| çŠ¶æ€åŒæ­¥ | loadingæ˜¾ç¤ºã€è¿›åº¦æ›´æ–°ã€ç»“æœæ­£ç¡® |
| é”™è¯¯å¤„ç† | å¤±è´¥æˆªå›¾ã€æ—¥å¿—è®°å½•ã€æŠ¥å‘Šç”Ÿæˆ |

---

## ä¹ã€Mockæ•°æ®ç¤ºä¾‹

### 9.1 GEOæ¨¡å—Mockæ•°æ®

```python
MOCK_PROJECT = {"name": "æµ‹è¯•é¡¹ç›®", "description": "è‡ªåŠ¨åŒ–æµ‹è¯•ç”¨"}
MOCK_KEYWORDS = ["SEOä¼˜åŒ–", "AIå†™ä½œ", "å†…å®¹è¥é”€", "å…³é”®è¯å·¥å…·"]
MOCK_DISTILL_RESULT = [
    "é•¿å°¾å…³é”®è¯æŒ–æ˜",
    "SEOå…³é”®è¯åˆ†æ",
    "æœç´¢å¼•æ“ä¼˜åŒ–æŠ€å·§",
    "å…³é”®è¯æ’åå·¥å…·"
]
```

### 9.2 ç›‘æ§æ¨¡å—Mockæ•°æ®

```python
MOCK_INDEX_RESULT = {
    "doubao": {"indexed": True, "rank": 3, "url": "https://..."},
    "qianwen": {"indexed": False, "rank": None},
    "deepseek": {"indexed": True, "rank": 7, "url": "https://..."}
}
MOCK_TREND_DATA = [
    {"date": "2025-01-15", "rate": 75.5},
    {"date": "2025-01-16", "rate": 82.3},
    {"date": "2025-01-17", "rate": 78.9}
]
MOCK_NOTIFICATION = {
    "type": "warning",
    "message": "å‘½ä¸­ç‡ä¸‹é™è¶…è¿‡20%",
    "keyword_id": 1
}
```

### 9.3 å‘å¸ƒæ¨¡å—Mockæ•°æ®

```python
MOCK_ARTICLE = {
    "title": "æµ‹è¯•æ–‡ç« æ ‡é¢˜",
    "content": "è¿™æ˜¯ä¸€ç¯‡è‡ªåŠ¨åŒ–æµ‹è¯•æ–‡ç« ...",
    "platforms": ["zhihu", "baijiahao"]
}
MOCK_PUBLISH_RESULT = {
    "zhihu": {"status": "success", "url": "https://zhihu.com/xxx"},
    "baijiahao": {"status": "failed", "error": "Cookieå·²è¿‡æœŸ"}
}
```

---

## åã€é™„å½•

### 10.1 æµ‹è¯•ç”¨ä¾‹ç»Ÿè®¡

| æ¨¡å— | ç”¨ä¾‹æ•°é‡ |
|------|----------|
| test_geo | 9 |
| test_monitor | 14 |
| test_publish | 14 |
| **æ€»è®¡** | **37** |

### 10.2 ä¾èµ–é¡¹

```txt
pytest>=7.4.0
pytest-html>=3.2.0
playwright>=1.40.0
requests>=2.31.0
```

### 10.3 ç¯å¢ƒè¦æ±‚

- Node.js 18+
- Python 3.10+
- Windows / macOS / Linux

---

**è®¾è®¡è€…**: å¼€å‘è€…
**æ–‡æ¡£æ—¥æœŸ**: 2025-01-17
**ç‰ˆæœ¬**: v1.0
